{
  "scanned_root": "C:\\Users\\thomas.weholt\\Desktop\\dotwork-main\\modules\\pystructmap\\src",
  "scanned_at": "2025-11-11T13:31:43.324265",
  "version": "0.1.0",
  "total_files": 7,
  "files": [
    {
      "path": "code_atlas\\agent_adapter.py",
      "entities": [
        {
          "type": "class",
          "name": "AgentAdapter",
          "lineno": 11,
          "end_lineno": 163,
          "docstring": "Unified interface combining query, rules, and scoring.",
          "methods": [
            "__init__",
            "get_symbol_location",
            "get_top_refactors",
            "get_rule_violations",
            "get_complex_functions",
            "get_dependency_hotspots",
            "get_untyped_or_poor_docs",
            "summarize_state"
          ],
          "bases": []
        },
        {
          "type": "function",
          "name": "__init__",
          "lineno": 14,
          "end_lineno": 29,
          "docstring": "Initialize agent adapter.\n\nArgs:\n    root: Workspace root directory\n    index_file: Path to code index JSON\n    rules_file: Path to rules YAML"
        },
        {
          "type": "function",
          "name": "get_symbol_location",
          "lineno": 31,
          "end_lineno": 40,
          "docstring": "Find where a symbol is defined.\n\nArgs:\n    symbol: Class or function name\n\nReturns:\n    Location info or None if not found"
        },
        {
          "type": "function",
          "name": "get_top_refactors",
          "lineno": 42,
          "end_lineno": 55,
          "docstring": "Get top refactor priority targets.\n\nArgs:\n    limit: Number of results\n\nReturns:\n    List of files with scores"
        },
        {
          "type": "function",
          "name": "get_rule_violations",
          "lineno": 57,
          "end_lineno": 71,
          "docstring": "Get all rule violations.\n\nReturns:\n    List of violations"
        },
        {
          "type": "function",
          "name": "get_complex_functions",
          "lineno": 73,
          "end_lineno": 82,
          "docstring": "Find functions exceeding complexity threshold.\n\nArgs:\n    threshold: Minimum complexity\n\nReturns:\n    List of complex functions"
        },
        {
          "type": "function",
          "name": "get_dependency_hotspots",
          "lineno": 84,
          "end_lineno": 114,
          "docstring": "Find files with high coupling.\n\nArgs:\n    min_edges: Minimum number of imports\n\nReturns:\n    List of highly coupled files"
        },
        {
          "type": "function",
          "name": "get_untyped_or_poor_docs",
          "lineno": 116,
          "end_lineno": 141,
          "docstring": "Find files with insufficient documentation.\n\nArgs:\n    min_comment_ratio: Minimum acceptable comment ratio\n\nReturns:\n    List of poorly documented files"
        },
        {
          "type": "function",
          "name": "summarize_state",
          "lineno": 143,
          "end_lineno": 163,
          "docstring": "Get compact summary of codebase state.\n\nReturns:\n    Summary dict with key metrics"
        }
      ],
      "complexity": [
        {
          "function": "AgentAdapter",
          "complexity": 3,
          "lineno": 11
        },
        {
          "function": "__init__",
          "complexity": 3,
          "lineno": 14
        },
        {
          "function": "get_symbol_location",
          "complexity": 1,
          "lineno": 31
        },
        {
          "function": "get_top_refactors",
          "complexity": 2,
          "lineno": 42
        },
        {
          "function": "get_rule_violations",
          "complexity": 3,
          "lineno": 57
        },
        {
          "function": "get_complex_functions",
          "complexity": 1,
          "lineno": 73
        },
        {
          "function": "get_dependency_hotspots",
          "complexity": 3,
          "lineno": 84
        },
        {
          "function": "get_untyped_or_poor_docs",
          "complexity": 3,
          "lineno": 116
        },
        {
          "function": "summarize_state",
          "complexity": 3,
          "lineno": 143
        }
      ],
      "raw": {
        "loc": 163,
        "sloc": 76,
        "comments": 3,
        "multi": 44,
        "blank": 38
      },
      "comment_ratio": 0.018,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    },
    {
      "path": "code_atlas\\cli.py",
      "entities": [
        {
          "type": "function",
          "name": "scan",
          "lineno": 18,
          "end_lineno": 28,
          "docstring": "Scan a Python codebase and generate structure index."
        },
        {
          "type": "function",
          "name": "rank",
          "lineno": 32,
          "end_lineno": 59,
          "docstring": "Rank files by refactor priority."
        },
        {
          "type": "function",
          "name": "check",
          "lineno": 63,
          "end_lineno": 91,
          "docstring": "Check code against quality rules."
        },
        {
          "type": "function",
          "name": "agent",
          "lineno": 95,
          "end_lineno": 132,
          "docstring": "Query codebase for agent integration (outputs JSON)."
        },
        {
          "type": "function",
          "name": "watch",
          "lineno": 136,
          "end_lineno": 211,
          "docstring": "Watch directory for Python file changes and update index."
        },
        {
          "type": "class",
          "name": "PythonFileHandler",
          "lineno": 154,
          "end_lineno": 176,
          "docstring": "Handle Python file change events.",
          "methods": [
            "on_modified",
            "on_created",
            "on_deleted"
          ],
          "bases": [
            "FileSystemEventHandler"
          ]
        },
        {
          "type": "function",
          "name": "on_modified",
          "lineno": 157,
          "end_lineno": 162,
          "docstring": "Handle file modification."
        },
        {
          "type": "function",
          "name": "on_created",
          "lineno": 164,
          "end_lineno": 169,
          "docstring": "Handle file creation."
        },
        {
          "type": "function",
          "name": "on_deleted",
          "lineno": 171,
          "end_lineno": 176,
          "docstring": "Handle file deletion."
        }
      ],
      "complexity": [
        {
          "function": "scan",
          "complexity": 1,
          "lineno": 18
        },
        {
          "function": "rank",
          "complexity": 2,
          "lineno": 32
        },
        {
          "function": "check",
          "complexity": 4,
          "lineno": 63
        },
        {
          "function": "agent",
          "complexity": 8,
          "lineno": 95
        },
        {
          "function": "watch",
          "complexity": 5,
          "lineno": 136
        }
      ],
      "raw": {
        "loc": 215,
        "sloc": 143,
        "comments": 22,
        "multi": 0,
        "blank": 46
      },
      "comment_ratio": 0.102,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    },
    {
      "path": "code_atlas\\query.py",
      "entities": [
        {
          "type": "class",
          "name": "CodeIndex",
          "lineno": 8,
          "end_lineno": 111,
          "docstring": "In-memory code index with fast lookup capabilities.",
          "methods": [
            "__init__",
            "_build_indices",
            "find",
            "complex",
            "dependencies",
            "top_complex"
          ],
          "bases": []
        },
        {
          "type": "function",
          "name": "__init__",
          "lineno": 11,
          "end_lineno": 20,
          "docstring": "Initialize code index from JSON file.\n\nArgs:\n    index_path: Path to code_index.json file"
        },
        {
          "type": "function",
          "name": "_build_indices",
          "lineno": 22,
          "end_lineno": 33,
          "docstring": "Build in-memory indices for O(1) lookups."
        },
        {
          "type": "function",
          "name": "find",
          "lineno": 35,
          "end_lineno": 44,
          "docstring": "Find entity by name.\n\nArgs:\n    name: Name of class or function to find\n\nReturns:\n    Entity information or None if not found"
        },
        {
          "type": "function",
          "name": "complex",
          "lineno": 46,
          "end_lineno": 69,
          "docstring": "Find functions exceeding complexity threshold.\n\nArgs:\n    threshold: Minimum complexity value\n\nReturns:\n    List of complex functions"
        },
        {
          "type": "function",
          "name": "dependencies",
          "lineno": 71,
          "end_lineno": 84,
          "docstring": "Get dependencies for a file.\n\nArgs:\n    file_path: Path to file\n\nReturns:\n    Dictionary with 'imports' and 'imported_by' lists"
        },
        {
          "type": "function",
          "name": "top_complex",
          "lineno": 86,
          "end_lineno": 111,
          "docstring": "Get top N most complex functions.\n\nArgs:\n    n: Number of results to return\n\nReturns:\n    List of most complex functions sorted by complexity descending"
        }
      ],
      "complexity": [
        {
          "function": "CodeIndex",
          "complexity": 3,
          "lineno": 8
        },
        {
          "function": "__init__",
          "complexity": 1,
          "lineno": 11
        },
        {
          "function": "_build_indices",
          "complexity": 3,
          "lineno": 22
        },
        {
          "function": "find",
          "complexity": 1,
          "lineno": 35
        },
        {
          "function": "complex",
          "complexity": 4,
          "lineno": 46
        },
        {
          "function": "dependencies",
          "complexity": 1,
          "lineno": 71
        },
        {
          "function": "top_complex",
          "complexity": 3,
          "lineno": 86
        }
      ],
      "raw": {
        "loc": 111,
        "sloc": 54,
        "comments": 1,
        "multi": 28,
        "blank": 25
      },
      "comment_ratio": 0.009,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    },
    {
      "path": "code_atlas\\rules.py",
      "entities": [
        {
          "type": "class",
          "name": "RuleEngine",
          "lineno": 9,
          "end_lineno": 100,
          "docstring": "Dynamic rule engine for code quality checks.",
          "methods": [
            "__init__",
            "evaluate",
            "_check_condition",
            "_get_avg_complexity"
          ],
          "bases": []
        },
        {
          "type": "function",
          "name": "__init__",
          "lineno": 12,
          "end_lineno": 19,
          "docstring": "Initialize rule engine from YAML file.\n\nArgs:\n    rules_path: Path to rules.yaml file"
        },
        {
          "type": "function",
          "name": "evaluate",
          "lineno": 21,
          "end_lineno": 51,
          "docstring": "Evaluate rules against file data.\n\nArgs:\n    file_data: File analysis data from scanner\n\nReturns:\n    List of rule violations with details"
        },
        {
          "type": "function",
          "name": "_check_condition",
          "lineno": 53,
          "end_lineno": 84,
          "docstring": "Check if condition is met.\n\nArgs:\n    condition: Condition expression to evaluate\n    file_data: File analysis data\n    metrics: Metrics thresholds\n\nReturns:\n    True if condition is met"
        },
        {
          "type": "function",
          "name": "_get_avg_complexity",
          "lineno": 86,
          "end_lineno": 100,
          "docstring": "Get average complexity for a file.\n\nArgs:\n    file_data: File analysis data\n\nReturns:\n    Average complexity value"
        }
      ],
      "complexity": [
        {
          "function": "RuleEngine",
          "complexity": 3,
          "lineno": 9
        },
        {
          "function": "__init__",
          "complexity": 1,
          "lineno": 12
        },
        {
          "function": "evaluate",
          "complexity": 3,
          "lineno": 21
        },
        {
          "function": "_check_condition",
          "complexity": 2,
          "lineno": 53
        },
        {
          "function": "_get_avg_complexity",
          "complexity": 3,
          "lineno": 86
        }
      ],
      "raw": {
        "loc": 100,
        "sloc": 50,
        "comments": 4,
        "multi": 24,
        "blank": 21
      },
      "comment_ratio": 0.04,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    },
    {
      "path": "code_atlas\\scanner.py",
      "entities": [
        {
          "type": "function",
          "name": "extract_entities",
          "lineno": 14,
          "end_lineno": 53,
          "docstring": "Extract all classes and functions from AST.\n\nArgs:\n    tree: Parsed AST tree\n\nReturns:\n    List of entity dicts with type, name, lineno, end_lineno, docstring"
        },
        {
          "type": "function",
          "name": "compute_metrics",
          "lineno": 56,
          "end_lineno": 90,
          "docstring": "Compute complexity and raw metrics.\n\nArgs:\n    source: Python source code\n\nReturns:\n    Tuple of (complexity list, raw metrics dict)"
        },
        {
          "type": "function",
          "name": "extract_git_metadata",
          "lineno": 93,
          "end_lineno": 139,
          "docstring": "Extract commit count, last author, last date.\n\nArgs:\n    path: Path to file\n\nReturns:\n    Dict with commits, last_author, last_commit"
        },
        {
          "type": "function",
          "name": "build_dependency_graph",
          "lineno": 142,
          "end_lineno": 190,
          "docstring": "Build dependency graph showing imports and imported_by relationships.\n\nArgs:\n    files_data: List of file analysis dicts\n\nReturns:\n    Dict mapping file paths to their dependencies"
        },
        {
          "type": "class",
          "name": "ASTScanner",
          "lineno": 193,
          "end_lineno": 300,
          "docstring": "Handles the scanning process for Python files.",
          "methods": [
            "__init__",
            "scan_file",
            "scan_directory"
          ],
          "bases": []
        },
        {
          "type": "function",
          "name": "scan_directory",
          "lineno": 303,
          "end_lineno": 314,
          "docstring": "Scan a directory of Python files and write index.\n\nArgs:\n    root_path: Root directory to scan\n    output_path: Path to write code_index.json"
        },
        {
          "type": "function",
          "name": "__init__",
          "lineno": 196,
          "end_lineno": 202,
          "docstring": "Initialize scanner with root directory.\n\nArgs:\n    root: Root directory to scan"
        },
        {
          "type": "function",
          "name": "scan_file",
          "lineno": 204,
          "end_lineno": 259,
          "docstring": "Scan a single Python file and extract structure and metrics.\n\nArgs:\n    path: Path to Python file to scan\n\nReturns:\n    Dictionary containing file analysis data"
        },
        {
          "type": "function",
          "name": "scan_directory",
          "lineno": 261,
          "end_lineno": 300,
          "docstring": "Scan all Python files in directory recursively.\n\nArgs:\n    incremental: Use incremental caching (not implemented yet)\n    deep: Enable deep analysis (not implemented yet)\n\nReturns:\n    Complete code_index dict"
        }
      ],
      "complexity": [
        {
          "function": "extract_entities",
          "complexity": 10,
          "lineno": 14
        },
        {
          "function": "compute_metrics",
          "complexity": 4,
          "lineno": 56
        },
        {
          "function": "extract_git_metadata",
          "complexity": 6,
          "lineno": 93
        },
        {
          "function": "build_dependency_graph",
          "complexity": 14,
          "lineno": 142
        },
        {
          "function": "scan_directory",
          "complexity": 1,
          "lineno": 303
        },
        {
          "function": "ASTScanner",
          "complexity": 5,
          "lineno": 193
        },
        {
          "function": "__init__",
          "complexity": 1,
          "lineno": 196
        },
        {
          "function": "scan_file",
          "complexity": 7,
          "lineno": 204
        },
        {
          "function": "scan_directory",
          "complexity": 5,
          "lineno": 261
        }
      ],
      "raw": {
        "loc": 314,
        "sloc": 197,
        "comments": 26,
        "multi": 46,
        "blank": 55
      },
      "comment_ratio": 0.083,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    },
    {
      "path": "code_atlas\\scoring.py",
      "entities": [
        {
          "type": "class",
          "name": "ScoringEngine",
          "lineno": 9,
          "end_lineno": 133,
          "docstring": "Weighted scoring for refactor priority ranking.",
          "methods": [
            "__init__",
            "score_file",
            "rank",
            "_get_avg_complexity",
            "_scale"
          ],
          "bases": []
        },
        {
          "type": "function",
          "name": "__init__",
          "lineno": 12,
          "end_lineno": 34,
          "docstring": "Initialize scoring engine from YAML file.\n\nArgs:\n    rules_path: Path to rules.yaml file"
        },
        {
          "type": "function",
          "name": "score_file",
          "lineno": 36,
          "end_lineno": 78,
          "docstring": "Compute weighted refactor priority score for a file.\n\nArgs:\n    file_data: File analysis data from scanner\n    dependencies: Dependency graph data\n\nReturns:\n    Score dict with file, metrics, and total score"
        },
        {
          "type": "function",
          "name": "rank",
          "lineno": 80,
          "end_lineno": 100,
          "docstring": "Rank all files by refactor priority score.\n\nArgs:\n    index: Complete code index from scanner\n\nReturns:\n    Sorted list of files with scores (highest priority first)"
        },
        {
          "type": "function",
          "name": "_get_avg_complexity",
          "lineno": 102,
          "end_lineno": 116,
          "docstring": "Get average complexity for a file.\n\nArgs:\n    file_data: File analysis data\n\nReturns:\n    Average complexity value"
        },
        {
          "type": "function",
          "name": "_scale",
          "lineno": 118,
          "end_lineno": 133,
          "docstring": "Scale value to 0-1 range.\n\nArgs:\n    value: Value to scale\n    min_val: Minimum expected value\n    max_val: Maximum expected value\n\nReturns:\n    Scaled value between 0 and 1"
        }
      ],
      "complexity": [
        {
          "function": "ScoringEngine",
          "complexity": 3,
          "lineno": 9
        },
        {
          "function": "__init__",
          "complexity": 5,
          "lineno": 12
        },
        {
          "function": "score_file",
          "complexity": 1,
          "lineno": 36
        },
        {
          "function": "rank",
          "complexity": 2,
          "lineno": 80
        },
        {
          "function": "_get_avg_complexity",
          "complexity": 3,
          "lineno": 102
        },
        {
          "function": "_scale",
          "complexity": 2,
          "lineno": 118
        }
      ],
      "raw": {
        "loc": 133,
        "sloc": 65,
        "comments": 7,
        "multi": 31,
        "blank": 29
      },
      "comment_ratio": 0.053,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    },
    {
      "path": "code_atlas\\__init__.py",
      "entities": [],
      "complexity": [],
      "raw": {
        "loc": 5,
        "sloc": 2,
        "comments": 0,
        "multi": 0,
        "blank": 2
      },
      "comment_ratio": 0.0,
      "git": {
        "commits": 0,
        "last_author": "",
        "last_commit": ""
      },
      "has_tests": true
    }
  ],
  "dependencies": {
    "code_atlas\\agent_adapter.py": {
      "imports": [],
      "imported_by": []
    },
    "code_atlas\\cli.py": {
      "imports": [],
      "imported_by": []
    },
    "code_atlas\\query.py": {
      "imports": [],
      "imported_by": []
    },
    "code_atlas\\rules.py": {
      "imports": [],
      "imported_by": []
    },
    "code_atlas\\scanner.py": {
      "imports": [],
      "imported_by": []
    },
    "code_atlas\\scoring.py": {
      "imports": [],
      "imported_by": []
    },
    "code_atlas\\__init__.py": {
      "imports": [],
      "imported_by": []
    }
  },
  "symbol_index": {
    "AgentAdapter": "code_atlas\\agent_adapter.py:11",
    "__init__": "code_atlas\\scoring.py:12",
    "get_symbol_location": "code_atlas\\agent_adapter.py:31",
    "get_top_refactors": "code_atlas\\agent_adapter.py:42",
    "get_rule_violations": "code_atlas\\agent_adapter.py:57",
    "get_complex_functions": "code_atlas\\agent_adapter.py:73",
    "get_dependency_hotspots": "code_atlas\\agent_adapter.py:84",
    "get_untyped_or_poor_docs": "code_atlas\\agent_adapter.py:116",
    "summarize_state": "code_atlas\\agent_adapter.py:143",
    "scan": "code_atlas\\cli.py:18",
    "rank": "code_atlas\\scoring.py:80",
    "check": "code_atlas\\cli.py:63",
    "agent": "code_atlas\\cli.py:95",
    "watch": "code_atlas\\cli.py:136",
    "PythonFileHandler": "code_atlas\\cli.py:154",
    "on_modified": "code_atlas\\cli.py:157",
    "on_created": "code_atlas\\cli.py:164",
    "on_deleted": "code_atlas\\cli.py:171",
    "CodeIndex": "code_atlas\\query.py:8",
    "_build_indices": "code_atlas\\query.py:22",
    "find": "code_atlas\\query.py:35",
    "complex": "code_atlas\\query.py:46",
    "dependencies": "code_atlas\\query.py:71",
    "top_complex": "code_atlas\\query.py:86",
    "RuleEngine": "code_atlas\\rules.py:9",
    "evaluate": "code_atlas\\rules.py:21",
    "_check_condition": "code_atlas\\rules.py:53",
    "_get_avg_complexity": "code_atlas\\scoring.py:102",
    "extract_entities": "code_atlas\\scanner.py:14",
    "compute_metrics": "code_atlas\\scanner.py:56",
    "extract_git_metadata": "code_atlas\\scanner.py:93",
    "build_dependency_graph": "code_atlas\\scanner.py:142",
    "ASTScanner": "code_atlas\\scanner.py:193",
    "scan_directory": "code_atlas\\scanner.py:261",
    "scan_file": "code_atlas\\scanner.py:204",
    "ScoringEngine": "code_atlas\\scoring.py:9",
    "score_file": "code_atlas\\scoring.py:36",
    "_scale": "code_atlas\\scoring.py:118"
  }
}